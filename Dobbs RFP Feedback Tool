<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dobbs RFP Screening Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px 30px;
        }
        
        .header h1 {
            font-size: 22px;
            margin-bottom: 5px;
        }
        
        .tabs {
            background: white;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            padding: 0 30px;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            font-size: 14px;
            color: #555;
            transition: all 0.2s;
        }
        
        .tab:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Sorting View Styles */
        .sorting-container {
            padding: 30px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .sorting-grid {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .applicant-pool {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .applicant-pool h3 {
            font-size: 14px;
            margin-bottom: 15px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .applicant-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .applicant-item {
            background: #f8f9fa;
            padding: 10px 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: move;
            border-left: 3px solid #95a5a6;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .applicant-item:hover {
            background: #e9ecef;
            transform: translateX(2px);
        }
        
        .applicant-item.dragging {
            opacity: 0.5;
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .category-box {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            min-height: 300px;
        }
        
        .category-box h3 {
            font-size: 14px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .category-qualified {
            border-top: 4px solid #27ae60;
        }
        
        .category-qualified h3 {
            color: #27ae60;
        }
        
        .category-sow {
            border-top: 4px solid #f39c12;
        }
        
        .category-sow h3 {
            color: #f39c12;
        }
        
        .category-undifferentiated {
            border-top: 4px solid #3498db;
        }
        
        .category-undifferentiated h3 {
            color: #3498db;
        }
        
        .category-unaligned {
            border-top: 4px solid #e74c3c;
        }
        
        .category-unaligned h3 {
            color: #e74c3c;
        }
        
        .drop-zone {
            min-height: 200px;
            border: 2px dashed #ddd;
            border-radius: 4px;
            padding: 10px;
        }
        
        .drop-zone.drag-over {
            background: #e3f2fd;
            border-color: #3498db;
        }
        
        .category-item {
            background: #f8f9fa;
            padding: 10px 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: move;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-qualified .category-item {
            border-left: 3px solid #27ae60;
        }
        
        .category-sow .category-item {
            border-left: 3px solid #f39c12;
        }
        
        .category-undifferentiated .category-item {
            border-left: 3px solid #3498db;
        }
        
        .category-unaligned .category-item {
            border-left: 3px solid #e74c3c;
        }
        
        .remove-btn {
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            font-size: 16px;
            padding: 0 5px;
        }
        
        .remove-btn:hover {
            color: #e74c3c;
        }
        
        .toolbar {
            padding: 20px 30px;
            background: #fafafa;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #95a5a6;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .stats {
            padding: 15px 30px;
            background: #ecf0f1;
            display: flex;
            gap: 30px;
            font-size: 13px;
        }
        
        .stat {
            color: #7f8c8d;
        }
        
        .stat strong {
            color: #2c3e50;
            font-weight: 600;
        }
        
        .search-box {
            margin-bottom: 15px;
        }
        
        .search-box input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }
        
        /* Comparison View Styles */
        .comparison-container {
            padding: 30px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            font-family: inherit;
        }
        
        textarea {
            min-height: 40px;
            resize: vertical;
        }
        
        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .delete-btn:hover {
            background: #c0392b;
        }
        
        .decision-decline { color: #e74c3c; font-weight: 600; }
        .decision-info { color: #f39c12; font-weight: 600; }
        .decision-interview { color: #27ae60; font-weight: 600; }
        
        .empty {
            text-align: center;
            padding: 60px;
            color: #95a5a6;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dobbs RFP Evaluation Tool</h1>
        <p>R. Howard Dobbs, Jr. Foundation - Impact Investing Strategy RFP</p>
    </div>
    
    <div class="tabs">
        <div class="tab active" onclick="switchTab('sorting')">Initial Sorting</div>
        <div class="tab" onclick="switchTab('comparison')">Decision Comparison</div>
    </div>
    
    <!-- Sorting Tab -->
    <div id="sortingTab" class="tab-content active">
        <div class="stats">
            <div class="stat">Total Applicants: <strong id="totalApplicants">43</strong></div>
            <div class="stat">Unsorted: <strong id="unsorted">27</strong></div>
            <div class="stat">Qualified: <strong id="qualifiedCount">4</strong></div>
            <div class="stat">SOW Consideration: <strong id="sowCount">3</strong></div>
            <div class="stat">Undifferentiated: <strong id="undiffCount">4</strong></div>
            <div class="stat">Unaligned: <strong id="unalignedCount">5</strong></div>
        </div>
        
        <div class="toolbar">
            <button class="btn btn-secondary" onclick="resetSorting()">Reset All</button>
            <button class="btn btn-secondary" onclick="exportSorting()">Export Results</button>
        </div>
        
        <div class="sorting-container">
            <div class="sorting-grid">
                <div class="applicant-pool">
                    <h3>Applicant Pool</h3>
                    <div class="search-box">
                        <input type="text" id="searchApplicants" placeholder="Search applicants..." onkeyup="filterApplicants()">
                    </div>
                    <div class="applicant-list" id="applicantList"><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="data-Fab">data-Fab</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Early Childhood Solutions">Early Childhood Solutions</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Ebony Brown">Ebony Brown</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Elemental Advisors">Elemental Advisors</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Evans &amp; Associates">Evans &amp; Associates</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Flat World Partners">Flat World Partners</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Georgia State University Research Foundation Inc.">Georgia State University Research Foundation Inc.</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Gingras Global">Gingras Global</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Holos Consulting Group, LLC">Holos Consulting Group, LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Hua Nani Partners LLC">Hua Nani Partners LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="IIIQ">IIIQ</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Insights4Equity">Insights4Equity</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="James Bui (Lotus Impact)">James Bui (Lotus Impact)</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Kashish Monchanda">Kashish Monchanda</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Kind Capital LLC">Kind Capital LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Matincrock Capital LLC">Matincrock Capital LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Mritunjay Sinha Consulting">Mritunjay Sinha Consulting</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="New Silk Roads">New Silk Roads</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="OviBees">OviBees</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="PROBLEM SOLVING PLUS, LLC">PROBLEM SOLVING PLUS, LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="S2 Strategies">S2 Strategies</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Spectrum Impact">Spectrum Impact</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="SVX">SVX</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Taylor Space">Taylor Space</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="TMG Strategic Advisors">TMG Strategic Advisors</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Tshiamo Impact Partners">Tshiamo Impact Partners</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Wilshire Advisors LLC">Wilshire Advisors LLC</div><div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Integrated Capital Strategies LLC">Integrated Capital Strategies LLC</div></div>
                </div>
                
                <div class="categories-grid">
                    <div class="category-box category-qualified">
                        <h3>Qualified and Appropriate SOW</h3>
                        <div class="drop-zone" id="qualified" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)"><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Brighter Investing PBLLC">
                        <span>Brighter Investing PBLLC</span>
                        <button class="remove-btn" onclick="removeFromCategory('qualified', `Brighter Investing PBLLC`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Lauren Murphy">
                        <span>Lauren Murphy</span>
                        <button class="remove-btn" onclick="removeFromCategory('qualified', `Lauren Murphy`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="J Denlinger Consulting LLC">
                        <span>J Denlinger Consulting LLC</span>
                        <button class="remove-btn" onclick="removeFromCategory('qualified', `J Denlinger Consulting LLC`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Community Capital Advisors LLC">
                        <span>Community Capital Advisors LLC</span>
                        <button class="remove-btn" onclick="removeFromCategory('qualified', `Community Capital Advisors LLC`)">×</button>
                    </div></div>
                    </div>
                    
                    <div class="category-box category-sow">
                        <h3>Qualified but SOW Warrants Consideration ($)</h3>
                        <div class="drop-zone" id="sow" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)"><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Activest">
                        <span>Activest</span>
                        <button class="remove-btn" onclick="removeFromCategory('sow', `Activest`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Impaqt Investment Consulting LLC">
                        <span>Impaqt Investment Consulting LLC</span>
                        <button class="remove-btn" onclick="removeFromCategory('sow', `Impactt Investment Consulting LLC`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Whistle Stop Capital">
                        <span>Whistle Stop Capital</span>
                        <button class="remove-btn" onclick="removeFromCategory('sow', `Whistle Stop Capital`)">×</button>
                    </div></div>
                    </div>
                    
                    <div class="category-box category-undifferentiated">
                        <h3>Qualified But Undifferentiated</h3>
                        <div class="drop-zone" id="undifferentiated" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)"><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Anna Kanze Hamilton">
                        <span>Anna Kanze Hamilton</span>
                        <button class="remove-btn" onclick="removeFromCategory('undifferentiated', `Anna Konza Hamilton`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Cogent Consulting SBC">
                        <span>Cogent Consulting SBC</span>
                        <button class="remove-btn" onclick="removeFromCategory('undifferentiated', `Cogent Consulting SBC`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Align Impact">
                        <span>Align Impact</span>
                        <button class="remove-btn" onclick="removeFromCategory('undifferentiated', `Align Impact`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Cardinal Impact Advisors">
                        <span>Cardinal Impact Advisors</span>
                        <button class="remove-btn" onclick="removeFromCategory('undifferentiated', `Cardinal Impact Advisors`)">×</button>
                    </div></div>
                    </div>
                    
                    <div class="category-box category-unaligned">
                        <h3>Unaligned Skills or Approach</h3>
                        <div class="drop-zone" id="unaligned" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)"><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Boyea Robinson LLC dba CopEQ Advisors">
                        <span>Boyea Robinson LLC dba CopEQ Advisors</span>
                        <button class="remove-btn" onclick="removeFromCategory('unaligned', `Boyea Robinson LLC dba CopEQ Advisors`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Companies for Causes">
                        <span>Companies for Causes</span>
                        <button class="remove-btn" onclick="removeFromCategory('unaligned', `Companies for Causes`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Tonna and Company">
                        <span>Tonna and Company</span>
                        <button class="remove-btn" onclick="removeFromCategory('unaligned', `Tonna and Company`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Equity at Work">
                        <span>Equity at Work</span>
                        <button class="remove-btn" onclick="removeFromCategory('unaligned', `Equity at Work`)">×</button>
                    </div><div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="Vintage Wealth Management Group, Inc.">
                        <span>Vintage Wealth Management Group, Inc.</span>
                        <button class="remove-btn" onclick="removeFromCategory('unaligned', `Vintage Wealth Management Group, Inc.`)">×</button>
                    </div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Comparison Tab -->
    <div id="comparisonTab" class="tab-content">
        <div class="stats">
            <div class="stat">Total: <strong id="compTotal">0</strong></div>
            <div class="stat">Reviewed: <strong id="compReviewed">0</strong></div>
            <div class="stat">Agree: <strong id="compAgree">0</strong></div>
            <div class="stat">Differ: <strong id="compDiffer">0</strong></div>
        </div>
        
        <div class="toolbar">
            <button class="btn" onclick="addComparisonOrg()">+ Add Organization</button>
            <button class="btn btn-secondary" onclick="exportComparisonCSV()">Export CSV</button>
        </div>
        
        <div class="comparison-container">
            <div id="comparisonTable"></div>
        </div>
    </div>

    <script>
        const applicants = [
            "Align Impact",
            "Anna Konza Hamilton",
            "Boyea Robinson LLC dba CopEQ Advisors",
            "Brighter Investing PBLLC",
            "Cogent Consulting SBC",
            "Companies for Causes",
            "doro-Fab",
            "Early Childhood Solutions",
            "Ebony Brown",
            "Elemental Advisors",
            "Equity at Work",
            "Evans & Associates",
            "Flori World Partners",
            "Georgia State University Research Foundation Inc.",
            "Gingras Global",
            "Halos Consulting Group, LLC",
            "Hue Nani Partners LLC",
            "IIIQ",
            "Insights4Equity",
            "James Bui (Lotus Impact)",
            "Kashish Monchanda",
            "Kind Capital LLC",
            "Malincrock Capital LLC",
            "Mhuntsly Sinha Consulting",
            "New Silk Roads",
            "OwBees",
            "PROBLEM SOLVING PLUS, LLC",
            "S2 Strategies",
            "Spectrum Impact",
            "SVX",
            "Taylor Space",
            "TMG Strategic Advisors",
            "Tshiamo Impact Partners",
            "Vintage Wealth Management Group, Inc.",
            "Whistle Stop Capital",
            "Wiltshire Advisors LLC",
            "Activest",
            "Cardinal Impact Advisors",
            "Community Capital Advisors LLC",
            "Impactt Investment Consulting LLC",
            "Integrated Capital Strategies LLC",
            "J Denlinger Consulting LLC",
            "Lauren Murphy"
        ];
        
        let sortingData = {
            qualified: [],
            sow: [],
            undifferentiated: [],
            unaligned: []
        };
        
        let comparisonData = [];
        
        function initSorting() {
            loadSortingData();
            renderApplicantList();
            renderCategories();
            updateSortingStats();
        }
        
        function renderApplicantList() {
            const list = document.getElementById('applicantList');
            const sorted = Object.values(sortingData).flat();
            const unsorted = applicants.filter(a => !sorted.includes(a));
            
            list.innerHTML = unsorted.map(name => 
                `<div class="applicant-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="${name.replace(/"/g, '&quot;')}">${name}</div>`
            ).join('');
        }
        
        function renderCategories() {
            ['qualified', 'sow', 'undifferentiated', 'unaligned'].forEach(category => {
                const zone = document.getElementById(category);
                zone.innerHTML = sortingData[category].map(name => {
                    const safeName = name.replace(/"/g, '&quot;').replace(/'/g, '&#39;');
                    return `<div class="category-item" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)" data-name="${safeName}">
                        <span>${name}</span>
                        <button class="remove-btn" onclick="removeFromCategory('${category}', \`${safeName}\`)">×</button>
                    </div>`;
                }).join('');
            });
        }
        
        function dragStart(ev) {
            ev.dataTransfer.setData("text/plain", ev.target.getAttribute('data-name'));
            ev.target.classList.add('dragging');
        }
        
        function dragEnd(ev) {
            ev.target.classList.remove('dragging');
        }
        
        function allowDrop(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.add('drag-over');
        }
        
        function dragLeave(ev) {
            ev.currentTarget.classList.remove('drag-over');
        }
        
        function drop(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('drag-over');
            
            const name = ev.dataTransfer.getData("text/plain");
            const category = ev.currentTarget.id;
            
            // Remove from all other categories
            Object.keys(sortingData).forEach(cat => {
                sortingData[cat] = sortingData[cat].filter(n => n !== name);
            });
            
            // Add to new category
            if (!sortingData[category].includes(name)) {
                sortingData[category].push(name);
            }
            
            saveSortingData();
            renderApplicantList();
            renderCategories();
            updateSortingStats();
        }
        
        function removeFromCategory(category, name) {
            sortingData[category] = sortingData[category].filter(n => n !== name);
            saveSortingData();
            renderApplicantList();
            renderCategories();
            updateSortingStats();
        }
        
        function updateSortingStats() {
            const sorted = Object.values(sortingData).flat();
            document.getElementById('unsorted').textContent = applicants.length - sorted.length;
            document.getElementById('qualifiedCount').textContent = sortingData.qualified.length;
            document.getElementById('sowCount').textContent = sortingData.sow.length;
            document.getElementById('undiffCount').textContent = sortingData.undifferentiated.length;
            document.getElementById('unalignedCount').textContent = sortingData.unaligned.length;
        }
        
        function filterApplicants() {
            const search = document.getElementById('searchApplicants').value.toLowerCase();
            const items = document.querySelectorAll('.applicant-item');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(search) ? 'block' : 'none';
            });
        }
        
        function resetSorting() {
            if (confirm('Reset all sorting? This will move all applicants back to the pool.')) {
                sortingData = { qualified: [], sow: [], undifferentiated: [], unaligned: [] };
                saveSortingData();
                renderApplicantList();
                renderCategories();
                updateSortingStats();
            }
        }
        
        function exportSorting() {
            let csv = 'Applicant,Category\n';
            Object.keys(sortingData).forEach(category => {
                const categoryName = category === 'qualified' ? 'Qualified and Appropriate SOW' :
                                    category === 'sow' ? 'Qualified but SOW Warrants Consideration' :
                                    category === 'undifferentiated' ? 'Qualified But Undifferentiated' :
                                    'Unaligned Skills or Approach';
                sortingData[category].forEach(name => {
                    csv += `"${name}","${categoryName}"\n`;
                });
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dobbs_initial_sorting.csv';
            a.click();
        }
        
        function saveSortingData() {
            localStorage.setItem('dobbsSorting', JSON.stringify(sortingData));
        }
        
        function loadSortingData() {
            const saved = localStorage.getItem('dobbsSorting');
            if (saved) {
                try {
                    sortingData = JSON.parse(saved);
                } catch(e) {
                    sortingData = { qualified: [], sow: [], undifferentiated: [], unaligned: [] };
                }
            }
        }
        
        // Comparison tab functions
        function initComparison() {
            loadComparisonData();
            renderComparisonTable();
        }
        
        function addComparisonOrg() {
            const name = prompt('Enter organization name:');
            if (!name) return;
            
            comparisonData.push({
                id: Date.now(),
                name: name,
                dobbs: '',
                mine: '',
                notes: ''
            });
            saveComparisonData();
            renderComparisonTable();
        }
        
        function renderComparisonTable() {
            const container = document.getElementById('comparisonTable');
            
            if (comparisonData.length === 0) {
                container.innerHTML = '<div class="empty"><h3>No organizations added yet</h3><p>Click "+ Add Organization" to start</p></div>';
                updateComparisonStats();
                return;
            }
            
            let html = '<table><thead><tr>';
            html += '<th style="width: 40px;">#</th>';
            html += '<th>Organization</th>';
            html += '<th style="width: 180px;">Dobbs Decision</th>';
            html += '<th style="width: 180px;">My Recommendation</th>';
            html += '<th>Notes</th>';
            html += '<th style="width: 60px;"></th>';
            html += '</tr></thead><tbody>';
            
            comparisonData.forEach((item, idx) => {
                html += '<tr>';
                html += `<td style="text-align: center; color: #999;">${idx + 1}</td>`;
                html += `<td><input type="text" value="${item.name}" onchange="updateComparison(${item.id}, 'name', this.value)"></td>`;
                
                html += `<td><select onchange="updateComparison(${item.id}, 'dobbs', this.value)">`;
                html += '<option value="">-- Select --</option>';
                html += `<option value="Decline" ${item.dobbs === 'Decline' ? 'selected' : ''}>Decline</option>`;
                html += `<option value="Need More Information" ${item.dobbs === 'Need More Information' ? 'selected' : ''}>Need More Information</option>`;
                html += `<option value="Invite for Interview" ${item.dobbs === 'Invite for Interview' ? 'selected' : ''}>Invite for Interview</option>`;
                html += '</select></td>';
                
                html += `<td><select onchange="updateComparison(${item.id}, 'mine', this.value)">`;
                html += '<option value="">-- Select --</option>';
                html += `<option value="Decline" ${item.mine === 'Decline' ? 'selected' : ''}>Decline</option>`;
                html += `<option value="Need More Information" ${item.mine === 'Need More Information' ? 'selected' : ''}>Need More Information</option>`;
                html += `<option value="Invite for Interview" ${item.mine === 'Invite for Interview' ? 'selected' : ''}>Invite for Interview</option>`;
                html += '</select></td>';
                
                html += `<td><textarea onchange="updateComparison(${item.id}, 'notes', this.value)">${item.notes}</textarea></td>`;
                html += `<td style="text-align: center;"><button class="delete-btn" onclick="deleteComparison(${item.id})">×</button></td>`;
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
            updateComparisonStats();
        }
        
        function updateComparison(id, field, value) {
            const item = comparisonData.find(d => d.id === id);
            if (item) {
                item[field] = value;
                saveComparisonData();
                updateComparisonStats();
            }
        }
        
        function deleteComparison(id) {
            if (confirm('Delete this organization?')) {
                comparisonData = comparisonData.filter(d => d.id !== id);
                saveComparisonData();
                renderComparisonTable();
            }
        }
        
        function updateComparisonStats() {
            document.getElementById('compTotal').textContent = comparisonData.length;
            const reviewed = comparisonData.filter(d => d.mine).length;
            document.getElementById('compReviewed').textContent = reviewed;
            const agree = comparisonData.filter(d => d.dobbs && d.mine && d.dobbs === d.mine).length;
            document.getElementById('compAgree').textContent = agree;
            const differ = comparisonData.filter(d => d.dobbs && d.mine && d.dobbs !== d.mine).length;
            document.getElementById('compDiffer').textContent = differ;
        }
        
        function exportComparisonCSV() {
            if (comparisonData.length === 0) {
                alert('No data to export');
                return;
            }
            
            let csv = 'Organization,Dobbs Decision,My Recommendation,Agreement,Notes\n';
            comparisonData.forEach(d => {
                const agreement = (d.dobbs && d.mine) ? (d.dobbs === d.mine ? 'Yes' : 'No') : 'N/A';
                csv += `"${d.name}","${d.dobbs}","${d.mine}","${agreement}","${d.notes}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dobbs_comparison.csv';
            a.click();
        }
        
        function saveComparisonData() {
            localStorage.setItem('dobbsComparison', JSON.stringify(comparisonData));
        }
        
        function loadComparisonData() {
            const saved = localStorage.getItem('dobbsComparison');
            if (saved) {
                try {
                    comparisonData = JSON.parse(saved);
                } catch(e) {
                    comparisonData = [];
                }
            }
        }
        
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'sorting') {
                document.querySelector('.tab:nth-child(1)').classList.add('active');
                document.getElementById('sortingTab').classList.add('active');
                initSorting();
            } else {
                document.querySelector('.tab:nth-child(2)').classList.add('active');
                document.getElementById('comparisonTab').classList.add('active');
                initComparison();
            }
        }
        
        // Initialize
        initSorting();
    </script>

</body></html>
